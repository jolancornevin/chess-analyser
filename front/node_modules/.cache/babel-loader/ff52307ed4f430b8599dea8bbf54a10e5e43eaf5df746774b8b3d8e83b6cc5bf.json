{"ast":null,"code":"import * as cg from './types.js';\nexport const invRanks = [...cg.ranks].reverse();\nexport const allKeys = Array.prototype.concat(...cg.files.map(c => cg.ranks.map(r => c + r)));\nexport const pos2key = pos => allKeys[8 * pos[0] + pos[1]];\nexport const key2pos = k => [k.charCodeAt(0) - 97, k.charCodeAt(1) - 49];\nexport const uciToMove = uci => {\n  if (!uci) return undefined;\n  if (uci[1] === '@') return [uci.slice(2, 4)];\n  return [uci.slice(0, 2), uci.slice(2, 4)];\n};\nexport const allPos = allKeys.map(key2pos);\nexport function memo(f) {\n  let v;\n  const ret = () => {\n    if (v === undefined) v = f();\n    return v;\n  };\n  ret.clear = () => {\n    v = undefined;\n  };\n  return ret;\n}\nexport const timer = () => {\n  let startAt;\n  return {\n    start() {\n      startAt = performance.now();\n    },\n    cancel() {\n      startAt = undefined;\n    },\n    stop() {\n      if (!startAt) return 0;\n      const time = performance.now() - startAt;\n      startAt = undefined;\n      return time;\n    }\n  };\n};\nexport const opposite = c => c === 'white' ? 'black' : 'white';\nexport const distanceSq = (pos1, pos2) => {\n  const dx = pos1[0] - pos2[0],\n    dy = pos1[1] - pos2[1];\n  return dx * dx + dy * dy;\n};\nexport const samePiece = (p1, p2) => p1.role === p2.role && p1.color === p2.color;\nexport const posToTranslate = bounds => (pos, asWhite) => [(asWhite ? pos[0] : 7 - pos[0]) * bounds.width / 8, (asWhite ? 7 - pos[1] : pos[1]) * bounds.height / 8];\nexport const translate = (el, pos) => {\n  el.style.transform = `translate(${pos[0]}px,${pos[1]}px)`;\n};\nexport const translateAndScale = (el, pos, scale = 1) => {\n  el.style.transform = `translate(${pos[0]}px,${pos[1]}px) scale(${scale})`;\n};\nexport const setVisible = (el, v) => {\n  el.style.visibility = v ? 'visible' : 'hidden';\n};\nexport const eventPosition = e => {\n  var _a;\n  if (e.clientX || e.clientX === 0) return [e.clientX, e.clientY];\n  if ((_a = e.targetTouches) === null || _a === void 0 ? void 0 : _a[0]) return [e.targetTouches[0].clientX, e.targetTouches[0].clientY];\n  return; // touchend has no position!\n};\nexport const isRightButton = e => e.buttons === 2 || e.button === 2;\nexport const createEl = (tagName, className) => {\n  const el = document.createElement(tagName);\n  if (className) el.className = className;\n  return el;\n};\nexport function computeSquareCenter(key, asWhite, bounds) {\n  const pos = key2pos(key);\n  if (!asWhite) {\n    pos[0] = 7 - pos[0];\n    pos[1] = 7 - pos[1];\n  }\n  return [bounds.left + bounds.width * pos[0] / 8 + bounds.width / 16, bounds.top + bounds.height * (7 - pos[1]) / 8 + bounds.height / 16];\n}","map":{"version":3,"names":["cg","invRanks","ranks","reverse","allKeys","Array","prototype","concat","files","map","c","r","pos2key","pos","key2pos","k","charCodeAt","uciToMove","uci","undefined","slice","allPos","memo","f","v","ret","clear","timer","startAt","start","performance","now","cancel","stop","time","opposite","distanceSq","pos1","pos2","dx","dy","samePiece","p1","p2","role","color","posToTranslate","bounds","asWhite","width","height","translate","el","style","transform","translateAndScale","scale","setVisible","visibility","eventPosition","e","clientX","clientY","_a","targetTouches","isRightButton","buttons","button","createEl","tagName","className","document","createElement","computeSquareCenter","key","left","top"],"sources":["/Users/jcornevin/Dev/Perso/chess-analyser/node_modules/chessground/src/util.ts"],"sourcesContent":["import * as cg from './types.js';\n\nexport const invRanks: readonly cg.Rank[] = [...cg.ranks].reverse();\n\nexport const allKeys: readonly cg.Key[] = Array.prototype.concat(...cg.files.map(c => cg.ranks.map(r => c + r)));\n\nexport const pos2key = (pos: cg.Pos): cg.Key => allKeys[8 * pos[0] + pos[1]];\n\nexport const key2pos = (k: cg.Key): cg.Pos => [k.charCodeAt(0) - 97, k.charCodeAt(1) - 49];\n\nexport const uciToMove = (uci: string | undefined): cg.Key[] | undefined => {\n  if (!uci) return undefined;\n  if (uci[1] === '@') return [uci.slice(2, 4) as cg.Key];\n  return [uci.slice(0, 2), uci.slice(2, 4)] as cg.Key[];\n};\n\nexport const allPos: readonly cg.Pos[] = allKeys.map(key2pos);\n\nexport function memo<A>(f: () => A): cg.Memo<A> {\n  let v: A | undefined;\n  const ret = (): A => {\n    if (v === undefined) v = f();\n    return v;\n  };\n  ret.clear = () => {\n    v = undefined;\n  };\n  return ret;\n}\n\nexport const timer = (): cg.Timer => {\n  let startAt: number | undefined;\n  return {\n    start() {\n      startAt = performance.now();\n    },\n    cancel() {\n      startAt = undefined;\n    },\n    stop() {\n      if (!startAt) return 0;\n      const time = performance.now() - startAt;\n      startAt = undefined;\n      return time;\n    },\n  };\n};\n\nexport const opposite = (c: cg.Color): cg.Color => (c === 'white' ? 'black' : 'white');\n\nexport const distanceSq = (pos1: cg.Pos, pos2: cg.Pos): number => {\n  const dx = pos1[0] - pos2[0],\n    dy = pos1[1] - pos2[1];\n  return dx * dx + dy * dy;\n};\n\nexport const samePiece = (p1: cg.Piece, p2: cg.Piece): boolean => p1.role === p2.role && p1.color === p2.color;\n\nexport const posToTranslate =\n  (bounds: ClientRect): ((pos: cg.Pos, asWhite: boolean) => cg.NumberPair) =>\n  (pos, asWhite) =>\n    [((asWhite ? pos[0] : 7 - pos[0]) * bounds.width) / 8, ((asWhite ? 7 - pos[1] : pos[1]) * bounds.height) / 8];\n\nexport const translate = (el: HTMLElement, pos: cg.NumberPair): void => {\n  el.style.transform = `translate(${pos[0]}px,${pos[1]}px)`;\n};\n\nexport const translateAndScale = (el: HTMLElement, pos: cg.NumberPair, scale = 1): void => {\n  el.style.transform = `translate(${pos[0]}px,${pos[1]}px) scale(${scale})`;\n};\n\nexport const setVisible = (el: HTMLElement, v: boolean): void => {\n  el.style.visibility = v ? 'visible' : 'hidden';\n};\n\nexport const eventPosition = (e: cg.MouchEvent): cg.NumberPair | undefined => {\n  if (e.clientX || e.clientX === 0) return [e.clientX, e.clientY!];\n  if (e.targetTouches?.[0]) return [e.targetTouches[0].clientX, e.targetTouches[0].clientY];\n  return; // touchend has no position!\n};\n\nexport const isRightButton = (e: cg.MouchEvent): boolean => e.buttons === 2 || e.button === 2;\n\nexport const createEl = (tagName: string, className?: string): HTMLElement => {\n  const el = document.createElement(tagName);\n  if (className) el.className = className;\n  return el;\n};\n\nexport function computeSquareCenter(key: cg.Key, asWhite: boolean, bounds: ClientRect): cg.NumberPair {\n  const pos = key2pos(key);\n  if (!asWhite) {\n    pos[0] = 7 - pos[0];\n    pos[1] = 7 - pos[1];\n  }\n  return [\n    bounds.left + (bounds.width * pos[0]) / 8 + bounds.width / 16,\n    bounds.top + (bounds.height * (7 - pos[1])) / 8 + bounds.height / 16,\n  ];\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}