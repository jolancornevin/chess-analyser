{"ast":null,"code":"import * as drag from './drag.js';\nimport * as draw from './draw.js';\nimport { drop } from './drop.js';\nimport { isRightButton } from './util.js';\nexport function bindBoard(s, onResize) {\n  const boardEl = s.dom.elements.board;\n  if ('ResizeObserver' in window) new ResizeObserver(onResize).observe(s.dom.elements.wrap);\n  if (s.viewOnly) return;\n  // Cannot be passive, because we prevent touch scrolling and dragging of\n  // selected elements.\n  const onStart = startDragOrDraw(s);\n  boardEl.addEventListener('touchstart', onStart, {\n    passive: false\n  });\n  boardEl.addEventListener('mousedown', onStart, {\n    passive: false\n  });\n  if (s.disableContextMenu || s.drawable.enabled) {\n    boardEl.addEventListener('contextmenu', e => e.preventDefault());\n  }\n}\n// returns the unbind function\nexport function bindDocument(s, onResize) {\n  const unbinds = [];\n  // Old versions of Edge and Safari do not support ResizeObserver. Send\n  // chessground.resize if a user action has changed the bounds of the board.\n  if (!('ResizeObserver' in window)) unbinds.push(unbindable(document.body, 'chessground.resize', onResize));\n  if (!s.viewOnly) {\n    const onmove = dragOrDraw(s, drag.move, draw.move);\n    const onend = dragOrDraw(s, drag.end, draw.end);\n    for (const ev of ['touchmove', 'mousemove']) unbinds.push(unbindable(document, ev, onmove));\n    for (const ev of ['touchend', 'mouseup']) unbinds.push(unbindable(document, ev, onend));\n    const onScroll = () => s.dom.bounds.clear();\n    unbinds.push(unbindable(document, 'scroll', onScroll, {\n      capture: true,\n      passive: true\n    }));\n    unbinds.push(unbindable(window, 'resize', onScroll, {\n      passive: true\n    }));\n  }\n  return () => unbinds.forEach(f => f());\n}\nfunction unbindable(el, eventName, callback, options) {\n  el.addEventListener(eventName, callback, options);\n  return () => el.removeEventListener(eventName, callback, options);\n}\nconst startDragOrDraw = s => e => {\n  if (s.draggable.current) drag.cancel(s);else if (s.drawable.current) draw.cancel(s);else if (e.shiftKey || isRightButton(e)) {\n    if (s.drawable.enabled) draw.start(s, e);\n  } else if (!s.viewOnly) {\n    if (s.dropmode.active) drop(s, e);else drag.start(s, e);\n  }\n};\nconst dragOrDraw = (s, withDrag, withDraw) => e => {\n  if (s.drawable.current) {\n    if (s.drawable.enabled) withDraw(s, e);\n  } else if (!s.viewOnly) withDrag(s, e);\n};","map":{"version":3,"names":["drag","draw","drop","isRightButton","bindBoard","s","onResize","boardEl","dom","elements","board","window","ResizeObserver","observe","wrap","viewOnly","onStart","startDragOrDraw","addEventListener","passive","disableContextMenu","drawable","enabled","e","preventDefault","bindDocument","unbinds","push","unbindable","document","body","onmove","dragOrDraw","move","onend","end","ev","onScroll","bounds","clear","capture","forEach","f","el","eventName","callback","options","removeEventListener","draggable","current","cancel","shiftKey","start","dropmode","active","withDrag","withDraw"],"sources":["/Users/jcornevin/Dev/Perso/chess-analyser/node_modules/chessground/src/events.ts"],"sourcesContent":["import { State } from './state.js';\nimport * as drag from './drag.js';\nimport * as draw from './draw.js';\nimport { drop } from './drop.js';\nimport { isRightButton } from './util.js';\nimport * as cg from './types.js';\n\ntype MouchBind = (e: cg.MouchEvent) => void;\ntype StateMouchBind = (d: State, e: cg.MouchEvent) => void;\n\nexport function bindBoard(s: State, onResize: () => void): void {\n  const boardEl = s.dom.elements.board;\n\n  if ('ResizeObserver' in window) new ResizeObserver(onResize).observe(s.dom.elements.wrap);\n\n  if (s.viewOnly) return;\n\n  // Cannot be passive, because we prevent touch scrolling and dragging of\n  // selected elements.\n  const onStart = startDragOrDraw(s);\n  boardEl.addEventListener('touchstart', onStart as EventListener, {\n    passive: false,\n  });\n  boardEl.addEventListener('mousedown', onStart as EventListener, {\n    passive: false,\n  });\n\n  if (s.disableContextMenu || s.drawable.enabled) {\n    boardEl.addEventListener('contextmenu', e => e.preventDefault());\n  }\n}\n\n// returns the unbind function\nexport function bindDocument(s: State, onResize: () => void): cg.Unbind {\n  const unbinds: cg.Unbind[] = [];\n\n  // Old versions of Edge and Safari do not support ResizeObserver. Send\n  // chessground.resize if a user action has changed the bounds of the board.\n  if (!('ResizeObserver' in window)) unbinds.push(unbindable(document.body, 'chessground.resize', onResize));\n\n  if (!s.viewOnly) {\n    const onmove = dragOrDraw(s, drag.move, draw.move);\n    const onend = dragOrDraw(s, drag.end, draw.end);\n\n    for (const ev of ['touchmove', 'mousemove']) unbinds.push(unbindable(document, ev, onmove as EventListener));\n    for (const ev of ['touchend', 'mouseup']) unbinds.push(unbindable(document, ev, onend as EventListener));\n\n    const onScroll = () => s.dom.bounds.clear();\n    unbinds.push(unbindable(document, 'scroll', onScroll, { capture: true, passive: true }));\n    unbinds.push(unbindable(window, 'resize', onScroll, { passive: true }));\n  }\n\n  return () => unbinds.forEach(f => f());\n}\n\nfunction unbindable(\n  el: EventTarget,\n  eventName: string,\n  callback: EventListener,\n  options?: AddEventListenerOptions\n): cg.Unbind {\n  el.addEventListener(eventName, callback, options);\n  return () => el.removeEventListener(eventName, callback, options);\n}\n\nconst startDragOrDraw =\n  (s: State): MouchBind =>\n  e => {\n    if (s.draggable.current) drag.cancel(s);\n    else if (s.drawable.current) draw.cancel(s);\n    else if (e.shiftKey || isRightButton(e)) {\n      if (s.drawable.enabled) draw.start(s, e);\n    } else if (!s.viewOnly) {\n      if (s.dropmode.active) drop(s, e);\n      else drag.start(s, e);\n    }\n  };\n\nconst dragOrDraw =\n  (s: State, withDrag: StateMouchBind, withDraw: StateMouchBind): MouchBind =>\n  e => {\n    if (s.drawable.current) {\n      if (s.drawable.enabled) withDraw(s, e);\n    } else if (!s.viewOnly) withDrag(s, e);\n  };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}